"use strict";var logGA=(...e)=>{};function activate(e,o){e.config.debug&&(logGA=(...e)=>{console.log("[GA] [ACTIVATE_ASSISTANT]",...e)}),logGA("QUERY:",o);var t=Object.assign({},e.config.assistantConfig);t.debug=e.config.debug,t.lang=o.lang,t.micConfig=e.config.micConfig,e.assistant=new e.lib.Assistant(e.lib,t,(o=>{e.sendSocketNotification("TUNNEL",o)}));var n={responseOutputCSS:e.config.responseConfig.responseOutputCSS,responseOutputURI:"tmp/responseOutput.html",responseOutputZoom:e.config.responseConfig.zoom.responseOutput},r=new e.lib.ScreenParser(e.lib,n,e.config.debug);e.assistant.activate(o,(t=>{t.lastQuery=o,t.screen||t.audio||(t.audio||t.screen||t.text||(t.error.error="NO_RESPONSE"),t.transcription&&t.transcription.transcription&&!t.transcription.done&&(t.error.error="TRANSCRIPTION_FAILS")),t&&t.error.audio&&!t.error.message&&(t.error.error="TOO_SHORT"),t.screen?r.parse(t,(o=>{delete o.screen.originalContent,logGA("RESULT",o),e.sendSocketNotification("ASSISTANT_RESULT",o)})):(logGA("RESULT",t),e.sendSocketNotification("ASSISTANT_RESULT",t))}))}exports.activate=activate;