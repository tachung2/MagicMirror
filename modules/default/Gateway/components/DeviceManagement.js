var log=(...e)=>{};function create(e){e.config.debug&&(log=(...e)=>{console.log("[GATEWAY] [SMARTHOME] [DEVICE]",...e)}),log("Create device..."),e.SmartHome.device={type:"action.devices.types.TV",traits:["action.devices.traits.Reboot","action.devices.traits.InputSelector"],name:{name:"Jarvis",defaultNames:["Jarvis","MagicMirror","Mirror"],nicknames:["Jarvis","MagicMirror","Mirror"]},attributes:{orderedInputs:!0,availableInputs:[{key:"Stop",names:[{lang:e.config.lang,name_synonym:["Stop","stop"]}]}]},willReportState:!0,roomHint:"MMM-GoogleAssistant",deviceInfo:{manufacturer:"@bugsounet",model:"MMM-GoogleAssistant",hwVersion:require("../package.json").version,swVersion:require("../package.json").rev}},setTimeout((()=>{e.Gateway.initialized&&(log("Collecting all EXTs installed..."),init(e))}),1e4)}function init(e){e.config.debug&&(log=(...e)=>{console.log("[GATEWAY] [SMARTHOME] [DEVICE]",...e)});let t=e.Gateway.EXTStatus;if(e.config.dev&&log("Received first GW status",t),e.SmartHome.EXT={"EXT-Screen":t["EXT-Screen"].hello,"EXT-Volume":t["EXT-Volume"].hello,"EXT-Pages":t["EXT-Pages"].hello,"EXT-Alert":t["EXT-Alert"].hello,"EXT-Spotify":t["EXT-Spotify"].hello,"EXT-SpotifyCanvasLyrics":t["EXT-SpotifyCanvasLyrics"].hello,"EXT-FreeboxTV":t["EXT-FreeboxTV"].hello},e.SmartHome.smarthome.Screen=t["EXT-Screen"].power,e.SmartHome.smarthome.Volume=t["EXT-Volume"].speaker,e.SmartHome.smarthome.VolumeIsMuted=t["EXT-Volume"].isMuted,e.SmartHome.smarthome.Page=t["EXT-Pages"].actual,e.SmartHome.smarthome.MaxPages=t["EXT-Pages"].total,e.SmartHome.smarthome.SpotifyIsConnected=t["EXT-Spotify"].connected,e.SmartHome.smarthome.SpotifyIsPlaying=t["EXT-Spotify"].play,e.SmartHome.smarthome.TvIsPlaying=t["EXT-FreeboxTV"].connected,e.SmartHome.smarthome.Lyrics=t["EXT-SpotifyCanvasLyrics"].hello&&(t["EXT-SpotifyCanvasLyrics"].connected?t["EXT-SpotifyCanvasLyrics"].connected:e.SmartHome.smarthome.SpotifyIsConnected&&e.SmartHome.smarthome.SpotifyIsPlaying),e.SmartHome.smarthome.LyricsIsForced=t["EXT-SpotifyCanvasLyrics"].forced,e.SmartHome.EXT["EXT-Screen"]&&(log("Found: EXT-Screen (action.devices.traits.OnOff)"),e.SmartHome.device.traits.push("action.devices.traits.OnOff")),e.SmartHome.EXT["EXT-Volume"]&&(log("Found: EXT-Volume (action.devices.traits.Volume)"),e.SmartHome.device.traits.push("action.devices.traits.Volume"),e.SmartHome.device.attributes.volumeMaxLevel=100,e.SmartHome.device.attributes.volumeCanMuteAndUnmute=!0,e.SmartHome.device.attributes.volumeDefaultPercentage=e.SmartHome.smarthome.Volume,e.SmartHome.device.attributes.levelStepSize=5),e.SmartHome.EXT["EXT-Pages"]){log("Found: EXT-Pages (action.devices.traits.InputSelector)");for(let t=0;t<e.SmartHome.smarthome.MaxPages;t++){log("Set: pages",t);let a={};a.key="page "+t,a.names=[],a.names[0]={},a.names[0].lang=e.SmartHome.lang,a.names[0].name_synonym=[],a.names[0].name_synonym[0]="page "+t,e.SmartHome.device.attributes.availableInputs.push(a)}}if(e.SmartHome.EXT["EXT-Alert"]&&(log("Found: EXT-Alert (action.devices.traits.Locator)"),e.SmartHome.device.traits.push("action.devices.traits.Locator")),e.SmartHome.EXT["EXT-Spotify"]){log("Found: EXT-Spotify (action.devices.traits.AppSelector, action.devices.traits.TransportControl)"),e.SmartHome.device.traits.push("action.devices.traits.AppSelector"),e.SmartHome.device.attributes.availableApplications=[];let t={key:"home",names:[{name_synonym:["home"],lang:e.SmartHome.lang}]},a={key:"spotify",names:[{name_synonym:["spotify"],lang:e.SmartHome.lang}]};e.SmartHome.device.attributes.availableApplications.push(t),e.SmartHome.device.attributes.availableApplications.push(a),e.SmartHome.device.traits.push("action.devices.traits.TransportControl"),e.SmartHome.device.attributes.transportControlSupportedCommands=["NEXT","PAUSE","PREVIOUS","RESUME","STOP"]}if(e.SmartHome.EXT["EXT-FreeboxTV"]){log("Found: EXT-FreeboxTV (action.devices.traits.Channel)"),e.SmartHome.device.traits.push("action.devices.traits.Channel");let t={key:"EXT-FreeboxTV",names:[{lang:e.SmartHome.lang,name_synonym:["EXT-FreeboxTV","FreeboxTV","Freebox TV"]}]};e.SmartHome.device.attributes.availableInputs.push(t)}if(e.SmartHome.EXT["EXT-SpotifyCanvasLyrics"]){log("Found: EXT-SpotifyCanvasLyrics (action.devices.traits.Channel)"),e.SmartHome.device.traits.push("action.devices.traits.Channel");let t={key:"EXT-SpotifyCanvasLyrics",names:[{lang:e.SmartHome.lang,name_synonym:["EXT-SpotifyCanvasLyrics","Lyrics","Canvas"]}]};e.SmartHome.device.attributes.availableInputs.push(t)}e.config.dev&&log("Your device is now:",e.SmartHome.device),e.SmartHome.homegraph?e.lib.homegraph.requestSync(e):console.log("[GATEWAY] [SMARTHOME] [DEVICE] HomeGraph is disabled."),e.SmartHome.init=!0}function refreshData(e){let t=e.Gateway.EXTStatus;e.SmartHome.oldSmartHome={Screen:e.SmartHome.smarthome.Screen,Volume:e.SmartHome.smarthome.Volume,VolumeIsMuted:e.SmartHome.smarthome.VolumeIsMuted,Page:e.SmartHome.smarthome.Page,MaxPages:e.SmartHome.smarthome.MaxPages,SpotifyIsConnected:e.SmartHome.smarthome.SpotifyIsConnected,SpotifyIsPlaying:e.SmartHome.smarthome.SpotifyIsPlaying,TvIsPlaying:e.SmartHome.smarthome.TvIsPlaying,Lyrics:e.SmartHome.smarthome.Lyrics,LyricsIsForced:e.SmartHome.smarthome.LyricsIsForced},e.SmartHome.smarthome.Screen=t["EXT-Screen"].power,e.SmartHome.smarthome.Volume=t["EXT-Volume"].speaker,e.SmartHome.smarthome.VolumeIsMuted=t["EXT-Volume"].isMuted,e.SmartHome.smarthome.Page=t["EXT-Pages"].actual,e.SmartHome.smarthome.MaxPages=t["EXT-Pages"].total,e.SmartHome.smarthome.SpotifyIsConnected=t["EXT-Spotify"].connected,e.SmartHome.smarthome.SpotifyIsPlaying=t["EXT-Spotify"].play,e.SmartHome.smarthome.TvIsPlaying=t["EXT-FreeboxTV"].connected,e.SmartHome.smarthome.Lyrics=t["EXT-SpotifyCanvasLyrics"].hello&&(t["EXT-SpotifyCanvasLyrics"].connected?t["EXT-SpotifyCanvasLyrics"].connected:e.SmartHome.smarthome.SpotifyIsConnected&&e.SmartHome.smarthome.SpotifyIsPlaying),e.SmartHome.smarthome.LyricsIsForced=t["EXT-SpotifyCanvasLyrics"].forced}exports.create=create,exports.init=init,exports.refreshData=refreshData;