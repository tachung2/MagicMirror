class GoogleSearch{constructor(t){this.lib=t,this.defaultUserAgent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:34.0) Gecko/20100101 Firefox/34.0",this.defaultLimit=10,this.defaultStart=0,this.getDefaultRequestOptions=({limit:t,query:e,userAgent:s,start:r})=>({url:"https://www.google.com/search",params:{q:e,num:t||this.defaultLimit,start:r||this.defaultStart},headers:{"User-Agent":s||this.defaultUserAgent}}),this.linkSelector="div.fP1Qef > div:nth-child(1) > a",this.getLinkSelector=t=>t||this.linkSelector,this.parseGoogleSearchResultUrl=t=>{if(t){if("/"===t.charAt(0)){return new URLSearchParams(t).get("url")}return t}}}getResults({data:t,linkSelector:e}){const s=this.lib.cheerio.load(t);let r=[];return s(this.getLinkSelector(e)).map(((t,e)=>{const s=this.parseGoogleSearchResultUrl(e.attribs.href);s.startsWith("http://www.google.com")||s.startsWith("https://www.google.com")||r.push({link:s})})),{results:r}}getResponse({query:t,limit:e,userAgent:s,start:r}){return new Promise(((o,i)=>{const l=this.getDefaultRequestOptions({limit:e,query:t,userAgent:s,start:r});this.lib.axios({...l}).then((t=>{const e=t.data;return o({body:e,response:t})})).catch((t=>i(new Error(`[GA] [GoogleSearch] Error making web request: ${t}`))))}))}googleIt(t){const{linkSelector:e,start:s}=t;return new Promise(((r,o)=>{this.getResponse(t).then((({body:t,response:i})=>{const{results:l}=this.getResults({data:t,linkSelector:e,start:s}),{status:a}=i;return 0===l.length&&200!==a&&o(new Error(`[GA] [GoogleSearch] Error in response: status ${a}.`)),r(l)})).catch(o)}))}}module.exports=GoogleSearch;