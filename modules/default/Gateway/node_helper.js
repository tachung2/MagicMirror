"use strict";var log=(...e)=>{},parseData=require("./components/parseData.js"),NodeHelper=require("node_helper");module.exports=NodeHelper.create({start:function(){this.Gateway={},this.SmartHome={},this.lib={error:0},parseData.init(this)},socketNotificationReceived:async function(e,i){switch(e){case"INIT":if(this.alreadyInitialized)return console.error("[GATEWAY] You can't use Gateway in server mode"),void this.sendSocketNotification("ERROR","You can't use Gateway in server mode");if(console.log("[GATEWAY] Gateway Version:",require("./package.json").version,"rev:",require("./package.json").rev),this.Gateway.server)return;this.config=i,this.config.debug&&(log=(...e)=>{console.log("[GATEWAY]",...e)}),this.sendSocketNotification("MMConfig");break;case"MMConfig":if(this.alreadyInitialized)return console.error("[GATEWAY] I say no! You can't use Gateway in server mode");if(this.alreadyInitialized=!0,await parseData.parse(this,i),this.lib.error||this.Gateway.errorInit)return;this.lib.Gateway.initialize(this),this.config.CLIENT_ID?this.lib.SmartHome.initialize(this):this.lib.SmartHome.disable(this),this.lib.Gateway.startServer(this,(e=>{e&&(console.log("[GATEWAY] Gateway Ready!"),this.sendSocketNotification("INITIALIZED"),this.lib.GWTools.setActiveVersion("Gateway",this))}));break;case"EXTStatus":this.Gateway.initialized&&i&&(this.Gateway.EXTStatus=i,this.SmartHome.use&&this.SmartHome.init&&(this.lib.Device.refreshData(this),this.lib.homegraph.updateGraph(this)));break;case"HELLO":if(!this.lib.GWTools)return console.error("[GATEWAY] internal error: lib GWTools not found!");this.lib.GWTools.setActiveVersion(i,this)}}});